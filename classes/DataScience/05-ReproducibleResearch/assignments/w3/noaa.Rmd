```{r}
library(data.table)

destFile <- 'stormdata.csv.bz2'
dataUrl <- 'https://d396qusza40orc.cloudfront.net/repdata/data/StormData.csv.bz2'

if (!file.exists(destFile)) {
    download.file(dataUrl, destfile=destFile, method='curl')
}

data <- as.data.table(read.csv(destFile))
nrow(data)

data[,.(totfat=sum(FATALITIES), totinj=sum(INJURIES)), .(EVTYPE)][order(-totfat, -totinj)][1:30]
```
